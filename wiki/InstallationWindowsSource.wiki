#summary Windows source code install instructions
#sidebar Installation

These instructions apply to version 0.15.  

These assume you have saved the Biodiverse source code to C:\biodiverse.  If you have not then change the `C:\biodiverse\lib` path in the following to the appropriate path.

_DO NOT USE A PATH WITH SPACES IN IT_.  This causes problems with the batch file used to run the source code version.  (This has no effect on the executable file).

If you don't like the window theme it uses then you can change it using the GTK+ Preference Tool from http://gtk-win.sourceforge.net/home/index.php/Gtk2Prefs

There are two options you can pursue here.  Both will work, but the !CamelBox install uses a more recent perl.

<wiki:toc max_depth="4" />


= !ActivePerl = 

== Installation (AS) ==

  * [http://code.google.com/p/biodiverse/downloads/list Download] the windows executable version for this, as it includes the Gtk binaries needed for the GUI.
  * Unzip the biodiverse directory onto your hard drive. These instructions assume you have placed it in C:\Biodiverse, but it can go anywhere on the file system.
  * Edit your system's PATH variable to include C:\Biodiverse\bin and C:\Biodiverse\gtk\bin.  Make sure the gtk path is before the system perl\bin path, as the trouchelle PPM repository adds incompatible binaries there. For an example of how to set the path, see http://www.computerhope.com/issues/ch000549.htm.
  * Download and install Perl 5.8.925 from http://downloads.activestate.com/ActivePerl/releases/5.8.9.827/ActivePerl-5.8.9.827-MSWin32-x86-291969.msi .  If you are on a 64 bit machine then make sure you use the 32 bit installation, as many of the libraries needed for the GUI are not yet compiled for 64 bit.
  
  * Once that's done, copy and paste the following commands into a command window. These install additional perl libraries needed by Biodiverse.
{{{
ppm repo add http://voltar.org/active/5.8
ppm repo add http://www.biodiverse.unsw.edu.au/ppm
ppm repo add http://trouchelle.com/ppm/
ppm install Bundle-BiodiverseNoGUI
ppm install Bundle-Biodiverse
ppm install mylib
ppm install Gnome2-Canvas
}}}

== Updating (AS) ==

  *  If you are updating an existing installation then it is for the most part a repeat the ppm steps from the installation process.
{{{
ppm repo add http://voltar.org/active/5.8
ppm repo add http://www.biodiverse.unsw.edu.au/ppm
ppm repo add http://trouchelle.com/ppm/
ppm install Bundle-BiodiverseNoGUI
ppm install Bundle-Biodiverse
ppm install mylib
}}}

== Running it (AS) ==

  *  You should now be able to run Biodiverse by executing `C:\Biodiverse\bin\BiodiverseGUI.bat` (or `C:\Biodiverse\bin\BiodiverseGUI.pl` if your system runs Perl files when they are double clicked).

= !CamelBox =

== Installation (CB) ==

This will require some interaction when it downloads additional packages, depending on your CPAN settings.  

  *  [http://code.google.com/p/biodiverse/downloads/list Download] the Biodiverse source code and save it to your hard drive.  
  *  Download and install !CamelBox from http://code.google.com/p/camelbox/ .  Install everything (the "Bloatware - Whole Enchilada" option).  This will install all the Gtk dependencies.
  *  Now you need to install the Biodiverse specific dependencies.  
{{{
perl -MCPAN -e "install Bundle::BiodiverseNoGUI"
perl -MCPAN -e "install Bundle::Biodiverse"
perl -MCPAN -e "install Gnome2::Canvas"
}}}

== Updating (CB) ==

  *  If you are updating an existing installation then repeat the cpan step from the installation process.
{{{
perl -MCPAN -e "install Bundle::BiodiverseNoGUI"
perl -MCPAN -e "install Bundle::Biodiverse"
}}}

  
== Running it (CB) ==

  * To run Biodiverse, open a terminal window and change directory to the biodiverse\bin folder.  If it is in C:\biodiverse\bin:
{{{
cd C:\biodiverse\bin
}}}
  * Once you have done this, type the following command to open Biodiverse.  This assumes you installed !CamelBox into C:\CamelBox, so change the following as necessary.
{{{
C:\CamelBox\bin\perl BiodiverseGUI.pl
}}}
  *  Alternately, you could give the full path to both Perl and Biodiverse if you want to start in a particular directory (i.e. where all your files are).
{{{
C:\CamelBox\bin\perl C:\biodiverse\bin\BiodiverseGUI.pl
}}}


The full path to perl is used to ensure the !CamelBox version is used.

= Trouble shooting =

  *  If you have more than one Perl and/or GTK installed on your system then you need to ensure that the versions you want to use are first in the PATH environment variable.  This is because the CamelBox binaries are not compatible with the ActiveState binaries.  You can manually edit the paths, but it is probably best to create a batch script to do this so it is easy to change things back and forth.
  *  !ActivePerl
    *  If, when using the !ActivePerl version, Perl complains that it cannot locate a file when running Biodiverse then this library will need to be installed interactively using the ppm utility.  The complaint will contain text like `Can't locate Fred/Fred.pm in @INC (@INC contains:...)`  In this case, install package Fred-Fred (substitute a hyphen for each forward slash "/", and remove the trailing ".pm" from the module it cannot locate). You can use the GUI version that comes with !ActivePerl, or install from the command line, e.g.: `ppm install Fred-Fred` . This can happen if one or more of the modules listed in the bundle failed to install.
  *  !CamelBox
    *  If, when using the !CamelBox version, Perl complains that it cannot locate a file when running Biodiverse then this library will need to be installed interactively using the cpan shell `sudo /opt/local/bin/cpan`. The complaint will contain text like `Can't locate Fred/Fred.pm in @INC (@INC contains:...)`  In this case, install module Fred::Fred (substitute a double colon "::" for each forward slash "/", and remove the trailing ".pm" from the module it cannot locate). E.g.: `C:\CamelBox\bin\perl -MCPAN -e 'install Fred::Fred'` . This can happen if one or more of the modules listed in the bundle failed to install.

  *  Please report any other issues using the [http://code.google.com/p/biodiverse/issues/list project issue tracker]